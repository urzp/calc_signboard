<style>
	.uc-hashtags{
		display: none; 
	}
	.font_button{
		cursor: pointer;
	}
	.font_panel{
		flex-wrap: wrap;
    	row-gap: 20px;
	}
</style>

<script>

	let buttons = [ ] //имена классов элементов для кнопок перечисленные через запятую в кавычках. Точка в переди обязатено нужна 
	const hashTags = [ ] //имена классов элементов для хештегов перечисленные через запятую в кавычках. Точка в переди обязатено нужна 

	const zeroBlock = '.uc-hashtags' // имя класса для зеро блока
	
	const buttonsTarget = '.font_panel'  // имя класса для блока куда вставляются кнопки
	const hTagTarget = '.js-product-controls-wrapper' // имя класса для блока куда вставляются хеш теги

	const buttonStyles = { // стили для кнопок 
		position:'inherit',
		'margin-left': '20px'
	}
	const hTagStyles = { // стили для хештегов
		position:'inherit',
		'margin-right': '10px',
		'margin-bottom':'10px',
	}
	const buttonsTargetStyles = { // стили для блока куда вставляются кнопки
		'display': 'flex'
	}
	const hTagTargetStyles = { // стили для блока куда вставляются хеш теги
		'display': 'flex',
		'flex-wrap': 'wrap',
		'margin-top': '20px',
		'margin-bottom':'20px',
	}

	const wrapCss = [
		'width',
		'height'
	]
	const tn_atomCss = [
		'color',
		'font-size',
		'font-family',
		'font-weight',
		'line-height',
		'border-style',
		'border-color',
		'border-width',
		'border-radius',
		'background-color',
		'background-position',
		'transition',
		'text-decoration',
		'display',
		'vertical-align',
		'text-align',
	]

	$( document ).ready( ()=>{
		renderPanel()
	})

	async function renderPanel(){
		await $('.font_button.clone').remove()
		fonts = await ajaxReq(URL_FONTS, AJAX_OPTIONS, {})
		buttons = []
		fonts.forEach(()=>{
			buttons.push('.font_button')
		})
		await cloneButtons()
		await cloneHashTags()
		await afterLoadElement('.js-product-controls-wrapper', cloneHashTags)
		await setAttrButons(fonts)
	}

	function setAttrButons(fonts){
		$('.font_button').each(function( index ){
			let name_font = fonts[index]?fonts[index].name:''
			let id_font = fonts[index]?fonts[index].id:''
			let available = fonts[index]?Number(fonts[index].available):1
			$(this).find('.tn-atom').text(name_font)
			$(this).attr({font:name_font})
			$(this).attr({id_font})
			$(this).click( function(){
				$('.edit_font_title .tn-atom').text(name_font)
				$('.t-checkbox__control input').prop('checked', available)
				$('.btn_reload_font').attr({id_font})
				$('.btn_delete_font').attr({id_font})
			})
		})
	}

	function afterLoadElement(cssSelector, callBack){
		let id_int = setInterval(()=>{
			if(!$(cssSelector)) return false
			callBack()
			clearInterval(id_int)	
		}, 1000)
	}

	function cloneButtons(){
		buttons.forEach(item =>{
			cloneElemrntTo(`${zeroBlock} ${item}`, buttonsTarget)
			$(item).css(buttonStyles)	
		})
		$(buttonsTarget).css(buttonsTargetStyles)
	}

	function cloneHashTags(){
		hashTags.forEach(item =>{
			cloneElemrntTo(`${zeroBlock} ${item}`, hTagTarget)
			$(item).css(hTagStyles)
		})
		$(hTagTarget).css(hTagTargetStyles)
	}

	function cloneElemrntTo(element_cssSelect, target_cssSelect){
		cloneCss( element_cssSelect + ' .tn-atom' )
		$( element_cssSelect ).clone().appendTo( target_cssSelect ).addClass('clone')
	}

	function cloneCss(cssSelect){
		let css_list = getCss(cssSelect, tn_atomCss ,wrapCss)
		$(cssSelect).css(css_list)
	}

	function getCss(cssSelect, cssProperties, cssParent){
		let result = {}
		cssParent.forEach( item => {
			result[item] = $(cssSelect).parent().css(item)
		} )
		cssProperties.forEach( item => {
			result[item] = $(cssSelect).css(item)
		} )
		return result
	}
</script>